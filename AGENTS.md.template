# arch2code Project Rules

## Role
You are an expert Hardware Architect and SystemVerilog/SystemC engineer using the **arch2code** toolchain. Your goal is to help define hardware architecture in YAML and implement it using the generated skeletons.

## Technology Stack

| Layer | Technology | Purpose |
|-------|------------|---------|
| **Architecture** | YAML | Define hardware blocks, interfaces, connections, registers |
| **Models** | SystemC (C++) | Functional simulation, behavioral modeling |
| **RTL** | SystemVerilog | Synthesizable hardware implementation |
| **Tooling** | Python | Code generation (arch2code toolchain) |
| **Build** | Make | Build orchestration, dependency management |
| **Co-simulation** | Verilator | RTL/SystemC tandem simulation |

### Languages & Standards
- **YAML**: Architecture definitions following arch2code schema
- **C++23**: SystemC models using IEEE 1666 SystemC standard
- **SystemVerilog**: IEEE 1800-2017 for RTL and packages
- **Python 3.8+**: arch2code generators (do not run directly)
- **GNU Make**: Build system

### Key Libraries & Frameworks
- **SystemC 2.3+**: Behavioral modeling and simulation
- **Verilator**: Open-source Verilog/SystemVerilog simulator
- **arch2code**: Code generation from YAML architecture

## Project Structure
- `arch/yaml/` - Architecture definitions (YAML) - Single Source of Truth
- `model/` - SystemC models
- `tb/` - SystemC testbenches  
- `rtl/` - SystemVerilog RTL
- `base/` - Generated base classes (DO NOT EDIT)
- `builder/` - arch2code toolchain (submodule)
- `rundir/` - **Primary working directory** (run most `make` commands here)

## Critical Constraints

### 1. Command Execution
- **ALWAYS** use `make` targets from `rundir/`:
  - `make gen` - Generate code from YAML
  - `make db` - Update project database
  - `make newmodule` - Create new modules (interactive)
  - `make run` - Execute the model with default testbench
  - `make clean` - Clean generated files
- RTL linting: `make lint` in the `rtl/` directory
- **NEVER** run `python arch2code.py` directly

### 2. Generated Code Protection
- **NEVER** edit between `GENERATED_CODE_BEGIN` and `GENERATED_CODE_END` markers
- If generated code needs changing, modify the YAML and rerun generators
- Only edit outside of these regions

### 3. File Creation
- **NEVER** manually create new implementation files (.sv, .cpp, .h)
- **ALWAYS** use `make newmodule` for new blocks/files

### 4. File Deletion
- **NEVER** delete implementation files unless explicitly requested by the user
- Files use in-place generation and will not be regenerated

## Naming Conventions
| Element | Convention | Example |
|---------|------------|---------|
| Constants | `UPPER_SNAKE_CASE` | `BUFFER_SIZE`, `DATA_WIDTH` |
| Types/Structures | `snake_case_t` | `byte_t`, `packet_t` |
| Blocks/Interfaces | `snake_case` | `dma_controller`, `data_stream` |
| Instances | `u_snake_case` | `u_fifo`, `u_cpu` |
| Enums | `UPPER_SNAKE_CASE` | `STATUS_IDLE`, `OPCODE_READ` |

## Task-Specific Guidance

Read the appropriate rules file for your current task:

| Task | Rules File |
|------|------------|
| **YAML Architecture** | `builder/base/rules/architecture-yaml.md` |
| **SystemC Models** | `builder/base/rules/systemc-shared.md` + `builder/base/rules/systemc-model.md` |
| **SystemC Testbenches** | `builder/base/rules/systemc-shared.md` + `builder/base/rules/systemc-testbench.md` |
| **SystemVerilog RTL** | `builder/base/rules/systemverilog-rtl.md` |

## Reference Documentation

For comprehensive details, consult:
- **Architecture & YAML**: `builder/base/ARCH2CODE_AI_RULES.md`
- **SystemC API**: `builder/base/SYSTEMC_API_USER_REFERENCE.md`
- **Schema Validation**: `builder/base/config/schema.yaml`
