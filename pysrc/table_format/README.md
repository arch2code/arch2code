# Generic Table Format Library

> **Initial version generated by AI:** GitHub Copilot - Claude Sonnet 4  
> **Date:** November 5, 2025  
> **Purpose:** Documentation for generic Python library for text-based tabular formatting



A flexible Python library for formatting various data structures in text-based tabular format. Uses only Python standard library - no external dependencies required.

## Features

- **Multiple Data Types**: Support for dictionaries, lists, JSON files
- **Custom Extractors**: Define how data is extracted and formatted for each column
- **Border Styles**: ASCII and minimal border styles
- **Flexible Columns**: Configurable column names and widths
- **Automatic Column Sizing**: Set width=0 for automatic sizing based on content length
- **Configurable Autosize Limits**: Prevent extremely wide columns with configurable maximum autosize width
- **Smart Truncation**: Two truncation modes for handling long text:
  - **Right-aligned truncation** (default): Shows end of text with ellipsis at beginning: "...end of text"
  - **Left-aligned truncation**: Shows start of text with ellipsis at end: "start of text..."
- **Error Handling**: Robust error handling and validation

## Quick Start

### Basic Dictionary Formatting

```python
from table_format import format_dict_table

data = {
    'server1': {'cpu': 45.2, 'memory': 78.5, 'status': 'active'},
    'server2': {'cpu': 32.8, 'memory': 65.3, 'status': 'active'}
}

# Option 1: Print directly (default behavior)
format_dict_table(
    data,
    [('Server', 15), ('CPU', 8), ('Memory', 8), ('Status', 10)],
    title="Server Status"
)

# Option 2: Get as string for further processing
table_string = format_dict_table(
    data,
    [('Server', 15), ('CPU', 8), ('Memory', 8), ('Status', 10)],
    title="Server Status",
    print_output=False
)
print("Table length:", len(table_string))
```

**Output:**
```
Server Status
=============
+-----------------+----------+----------+------------+
| Server          | CPU      | Memory   | Status     |
+-----------------+----------+----------+------------+
| server1         | 45.2     | 78.5     | active     |
| server2         | 32.8     | 65.3     | active     |
+-----------------+----------+----------+------------+

Total entries: 2
```

### List of Dictionaries

```python
from table_format import format_list_table

transactions = [
    {'id': 'TXN001', 'amount': 150.75, 'type': 'credit'},
    {'id': 'TXN002', 'amount': 45.20, 'type': 'debit'}
]

# Print to console (default)
format_list_table(
    transactions,
    [('ID', 8), ('Amount', 12), ('Type', 8)],
    title="Transactions"
)

# Get as string for logging or file output
log_table = format_list_table(
    transactions,
    [('ID', 8), ('Amount', 12), ('Type', 8)],
    title="Transactions",
    print_output=False
)
with open("transaction_log.txt", "w") as f:
    f.write(log_table)
```

**Output:**
```
Transactions
============
+----------+--------------+----------+
| ID       | Amount       | Type     |
+----------+--------------+----------+
| TXN001   | 150.75       | credit   |
| TXN002   | 45.2         | debit    |
+----------+--------------+----------+

Total entries: 2
```

### JSON File Formatting

```python
from table_format import format_json_file

# Format directly
format_json_file(
    "data.json",
    [('Key', 20), ('Value', 30)],
    title="Configuration"
)

# Get as string for web API response
table_html = format_json_file(
    "data.json",
    [('Key', 20), ('Value', 30)],
    title="Configuration",
    print_output=False
)
# Convert to HTML table or include in response...
```

**Note:** This example assumes a JSON file exists. The output format is the same as dictionary formatting, with the JSON data loaded and processed into a table structure.

### Automatic Column Sizing

```python
from table_format import format_dict_table

# Use width=0 for automatic column sizing
data = {
    'short': 'Small value',
    'medium_length_key': 'This is a medium length value',
    'very_long_key_name_here': 'This is a very long value that would normally require width planning'
}

# All columns autosize to fit content
format_dict_table(
    data,
    [('Key', 0), ('Value', 0)],  # width=0 means autosize
    title="Automatic Sizing Example"
)

# Mixed sizing: some fixed, some autosize
format_dict_table(
    data,
    [('Key', 15), ('Value', 0)],  # Fixed 15 for Key, autosize for Value
    title="Mixed Sizing Example"
)
```

**Output (All columns autosize):**
```
Automatic Sizing Example
========================
+-------------------------+----------------------------------------------------+
| Key                     | Value                                              |
+-------------------------+----------------------------------------------------+
| short                   | Small value                                        |
| medium_length_key       | This is a medium length value                      |
| very_long_key_name_here | ...alue that would normally require width planning |
+-------------------------+----------------------------------------------------+

Total entries: 3
```

**Output (Mixed sizing - Key fixed at 15, Value autosized):**
```
Mixed Sizing Example
====================
+-----------------+----------------------------------------------------+
| Key             | Value                                              |
+-----------------+----------------------------------------------------+
| short           | Small value                                        |
| ...m_length_key | This is a medium length value                      |
| ...ey_name_here | ...alue that would normally require width planning |
+-----------------+----------------------------------------------------+

Total entries: 3
```

### Configurable Autosize Width Limits

The autosize feature includes configurable maximum width limits to prevent extremely wide columns:

```python
from table_format import format_dict_table, TableFormatter

# Default maximum autosize width is 50 characters
data = {
    'key1': 'This is a very long value that exceeds the default autosize limit and will be truncated',
    'key2': 'Short value'
}

# Using convenience function with default limit (50)
format_dict_table(
    data,
    [('Key', 0), ('Value', 0)],  # Both columns autosize
    title="Default Autosize Limits (50 chars max)"
)

# Custom maximum autosize width
format_dict_table(
    data,
    [('Key', 0), ('Value', 0)],
    title="Custom Autosize Limits (20 chars max)",
    max_autosize_width=20
)

# Using TableFormatter class for more control
table = TableFormatter(max_autosize_width=30)
result = table.format_dict_table(
    data,
    [('Key', 0), ('Value', 0)],
    title="Class-based Custom Limits (30 chars max)"
)
print(result)

# Large limit for wide displays
format_dict_table(
    data,
    [('Key', 0), ('Value', 0)],
    title="Wide Display Limits (100 chars max)",
    max_autosize_width=100
)
```

**Output (Default 50 character limit):**
```
Default Autosize Limits (50 chars max)
======================================
+-------+----------------------------------------------------+
| Key   | Value                                              |
+-------+----------------------------------------------------+
| key1  | ...he default autosize limit and will be truncated |
| key2  | Short value                                        |
+-------+----------------------------------------------------+

Total entries: 2
```

**Output (Custom 20 character limit):**
```
Custom Autosize Limits (20 chars max)
=====================================
+-------+----------------------+
| Key   | Value                |
+-------+----------------------+
| key1  | ...will be truncated |
| key2  | Short value          |
+-------+----------------------+

Total entries: 2
```

**Key Points:**
- Default `max_autosize_width` is 50 characters
- Only affects columns with `width=0` (autosize enabled)
- Uses existing truncation mechanism when content exceeds limit
- Can be set per-table via convenience functions or per-instance via TableFormatter constructor
- Fixed-width columns (width > 0) are not affected by this limit

## Advanced Usage

### Custom Data Extractor

```python
from table_format import TableFormatter

# Sample data with nested structure
data = {
    'instance1': {'memory': 'RAM', 'offset': 1024, 'regAccess': True},
    'instance2': {'memory': 'ROM', 'offset': 2048, 'regAccess': False},
    'instance3': {'memory': 'CACHE', 'offset': 4096, 'regAccess': True}
}

def custom_extractor(key, value, columns):
    """Extract specific data for each column"""
    return [
        key,                                    # Instance name
        value.get('memory', ''),               # Memory field
        f"{value.get('offset', 0):08x}",       # Hex formatted offset
        'Yes' if value.get('regAccess') else 'No'  # Formatted boolean
    ]

table = TableFormatter()
table_string = table.format_dict_table(
    data,
    [('Instance', 30), ('Memory', 15), ('Offset', 10), ('Access', 8)],
    extractor=custom_extractor
)
print(table_string)
```

**Output:**
```
+--------------------------------+-----------------+------------+----------+
| Instance                       | Memory          | Offset     | Access   |
+--------------------------------+-----------------+------------+----------+
| instance1                      | RAM             | 00000400   | Yes      |
| instance2                      | ROM             | 00000800   | No       |
| instance3                      | CACHE           | 00001000   | Yes      |
+--------------------------------+-----------------+------------+----------+

Total entries: 3
```

### Border Styles

```python
from table_format import TableFormatter

data = {
    'style1': 'Standard ASCII borders',
    'style2': 'Minimal spacing'
}
columns = [('Key', 15), ('Value', 30)]

# ASCII borders (default)
table = TableFormatter('ascii')
result = table.format_dict_table(data, columns)
print(result)

# Minimal spacing
table = TableFormatter('minimal')
result = table.format_dict_table(data, columns)
print(result)
```

**Output (ASCII Style):**
```
+-----------------+--------------------------------+
| Key             | Value                          |
+-----------------+--------------------------------+
| style1          | Standard ASCII borders         |
| style2          | Minimal spacing                |
+-----------------+--------------------------------+

Total entries: 2
```

**Output (Minimal Style):**
```
 ----------------- --------------------------------
  Key               Value
 ----------------- --------------------------------
  style1            Standard ASCII borders
  style2            Minimal spacing
 ----------------- --------------------------------

Total entries: 2
```

**Border Style Differences:**
- **ASCII**: Uses `+` for corners, creating traditional box-drawing appearance
- **Minimal**: Uses spaces for corners and vertical borders, most minimal visual impact

### Truncation Modes

```python
from table_format import TableFormatter

data = {
    'file1': 'very_long_filename_that_exceeds_column_width.txt',
    'file2': '/path/to/very/long/directory/structure/file.log',
    'url': 'https://example.com/api/v1/users/12345/profile/settings',
    'description': 'This is a very long description that will exceed the column width'
}
columns = [('Key', 12), ('Value', 25)]

# Right-aligned truncation (default) - shows end of text
table = TableFormatter(truncation_mode='right')
result = table.format_dict_table(data, columns)
print(result)
# Long text formats as: "...end of text"

# Left-aligned truncation - shows start of text
table = TableFormatter(truncation_mode='left')
result = table.format_dict_table(data, columns)
print(result)
# Long text formats as: "start of text..."

# Both parameters can be combined
table = TableFormatter('minimal', 'left')
result = table.format_dict_table(data, columns)
print(result)
```

**Output (Right-aligned truncation - shows end):**
```
Right Truncation Demo
=====================
+--------------+---------------------------+
| Key          | Value                     |
+--------------+---------------------------+
| file1        | ...ceeds_column_width.txt |
| file2        | ...ory/structure/file.log |
| url          | ...12345/profile/settings |
| description  | ...xceed the column width |
+--------------+---------------------------+

Total entries: 4
```

**Output (Left-aligned truncation - shows start):**
```
Left Truncation Demo
====================
+--------------+---------------------------+
| Key          | Value                     |
+--------------+---------------------------+
| file1        | very_long_filename_tha... |
| file2        | /path/to/very/long/dir... |
| url          | https://example.com/ap... |
| description  | This is a very long de... |
+--------------+---------------------------+

Total entries: 4
```

## Specialized Modules

### Memory Instances Formatting

The `meminsts_display.py` module provides specialized formatting for memory instance data:

```python
from meminsts_display import format_meminsts_table

# Default columns optimized for memory instances
format_meminsts_table("meminsts.json")

# Custom columns
custom_columns = [
    ('Instance', 35),
    ('Memory', 20),
    ('Description', 40),
    ('Offset', 10)
]
format_meminsts_table("meminsts.json", custom_columns)
```

## Files

- **`table_format.py`** - Core generic table formatting library
- **`meminsts_display.py`** - Specialized module for memory instances
- **`demo_table_library.py`** - Comprehensive demonstration script
- **`test_table_format.py`** - Comprehensive test suite

## API Reference

### TableFormatter Class

#### Methods

- `format_dict_table(data, columns, extractor=None, title=None, show_total=True)` → `str`
- `format_list_table(data, columns, extractor=None, title=None, show_total=True)` → `str`
- `format_json_file(json_file_path, columns, extractor=None, title=None)` → `str`

All methods return the formatted table as a string.

#### Parameters

- **`data`**: Dictionary or list to format
- **`columns`**: List of tuples `(column_name, width)` where width=0 triggers autosize
- **`extractor`**: Optional function to customize data extraction
- **`title`**: Optional table title
- **`show_total`**: Whether to show total entry count

### Column Width Specification

When specifying columns, you can use:
- **Fixed width**: `('Column Name', 20)` - Column will be exactly 20 characters wide
- **Autosize**: `('Column Name', 0)` - Column will automatically size to fit content
- **Mixed**: Mix fixed and autosize columns as needed

Autosize behavior:
- Analyzes all data to find the longest content in each column
- Sets width to accommodate the longest content (minimum: header width)
- Applies configurable maximum width limit (default: 50 characters)
- Very long content beyond the maximum will be truncated using the selected truncation mode

### Convenience Functions

- `format_dict_table(data, columns, extractor=None, title=None, border_style='ascii', truncation_mode='right', print_output=True, max_autosize_width=50)` → `str`
- `format_list_table(data, columns, extractor=None, title=None, border_style='ascii', truncation_mode='right', print_output=True, max_autosize_width=50)` → `str`
- `format_json_file(json_file_path, columns, extractor=None, title=None, border_style='ascii', truncation_mode='right', print_output=True, max_autosize_width=50)` → `str`

**Parameters:**
- **`columns`**: List of tuples `(column_name, width)` where width=0 enables autosize
- **`print_output`**: Set to `False` to return the table string without printing it
- **`max_autosize_width`**: Maximum width for autosize columns (default: 50)
- All other parameters same as TableFormatter methods

### TableFormatter Constructor

```python
TableFormatter(border_style='ascii', truncation_mode='right', max_autosize_width=50)
```

**Parameters:**
- **`border_style`**: Border style ('ascii', 'minimal')
- **`truncation_mode`**: Text truncation behavior ('right', 'left')
  - **'right'** (default): Ellipsis at beginning, preserves end of text: "...important_end"
  - **'left'**: Ellipsis at end, preserves start of text: "important_start..."
- **`max_autosize_width`**: Maximum width for autosize columns (default: 50)
  - Only affects columns with `width=0` (autosize enabled)
  - Content exceeding this limit is truncated using the selected truncation mode
  - Fixed-width columns (width > 0) are not affected by this limit

## Examples

Run the demonstration script to see various usage examples:

```bash
python3 demo_table_library.py
```

This will show:
1. Simple configuration settings
2. Server performance metrics
3. Financial transaction logs
4. Different border styles
5. Truncation mode demonstrations
6. **Autosize feature demonstrations**

## Testing

Run the comprehensive test suite:

```bash
python3 test_table_format.py
```

This validates:
- Truncation edge cases
- Header width enforcement
- Border style functionality
- String return API
- **Autosize functionality and edge cases**

## Requirements

- Python 3.6+
- No external dependencies (uses only standard library)

## License

This library is provided as-is for demonstration and educational purposes.